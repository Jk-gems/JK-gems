<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>J.K Gems - Exquisite Gemstones & Spiritual Items</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;600;700&family=Lora:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* --- Color Palette Variables (Default: Light Theme) --- */
        :root {
            /* Light Theme Colors */
            --primary-color: #1A3A4E; /* Deep Navy/Teal: Headings, Header/Footer Background */
            --secondary-color: #B88A45; /* Muted Gold/Bronze: Accent, Links, Highlights, Button Hover */
            --background-color: #F5F5DC; /* Light Beige/Cream: Body Background */
            --surface-color: #FFFFFF; /* Card/Modal/Section Background */
            --text-color-dark: #333333; /* Dark Grey: Main Text */
            --text-color-medium: #555555; /* Secondary Text/Descriptions */
            --border-color: #D3D3D3; /* Light Grey: Borders, Separators */

            --whatsapp-green: #25D366;
            --whatsapp-green-hover: #1DA851;

            --footer-text-color: var(--text-color-dark);

            --section-padding-vertical: 100px;
            --section-padding-horizontal: 25px;

            /* Button Colors */
            --button-primary-bg: var(--primary-color);
            --button-primary-text: var(--background-color);
            --button-primary-hover-bg: var(--secondary-color);
            --button-primary-hover-text: var(--primary-color);

            --button-secondary-bg: var(--secondary-color);
            --button-secondary-text: var(--primary-color);
            --button-secondary-hover-bg: var(--primary-color);
            --button-secondary-hover-text: var(--background-color);
        }

        /* --- Dark Theme Variables --- */
        body.dark-theme {
            --primary-color: #B88A45; /* Gold becomes a primary accent */
            --secondary-color: #1A3A4E; /* Deep Navy becomes a secondary accent/background element */
            --background-color: #181818; /* Main Dark Background */
            --surface-color: #282828; /* Card/Modal/Section Background */
            --text-color-dark: #FFFFFF; /* White: Headings, Important Text */
            --text-color-medium: #E0E0E0; /* Main Light Text */
            --text-color-secondary: #AAAAAA; /* Secondary Text/Descriptions */
            --border-color: #444444; /* Darker Borders/Separators */

            --whatsapp-green: #25D366; /* Keep green */
            --whatsapp-green-hover: #1DA851;

            --footer-text-color: var(--text-color-secondary);

            /* Button Colors adapted for dark theme */
            --button-primary-bg: var(--primary-color); /* Use Gold */
            --button-primary-text: var(--background-color); /* Dark text on gold */
            --button-primary-hover-bg: #d4a863; /* Lighter gold on hover */
            --button-primary-hover-text: var(--background-color);

            --button-secondary-bg: var(--secondary-color); /* Use Deep Navy */
            --button-secondary-text: var(--text-color-medium);
            --button-secondary-hover-bg: #2a546a; /* Slightly lighter Navy */
            --button-secondary-hover-text: var(--text-color-dark);

            /* Subtle Dark Background Pattern */
            background-image: linear-gradient(45deg, #1f1f1f 25%, transparent 25%, transparent 75%, #1f1f1f 75%, #1f1f1f),
                              linear-gradient(-45deg, #1f1f1f 25%, transparent 25%, transparent 75%, #1f1f1f 75%, #1f1f1f);
            background-size: 20px 20px; /* Adjust size as needed */
        }


        /* --- Base Styles (Using Variables) --- */
        body {
            font-family: 'Lato', sans-serif;
            font-weight: 400;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color-medium);
            line-height: 1.6;
            overflow-x: hidden;
            scroll-behavior: smooth;
            transition: background-color 0.5s ease, color 0.5s ease, background-image 0.5s ease; /* Smooth theme transition */
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Lora', serif;
            color: var(--primary-color);
            line-height: 1.3;
            margin-top: 0;
            transition: color 0.5s ease; /* Smooth theme transition */
        }

        h2 {
            font-size: 2.8em;
            margin-bottom: 40px;
            text-align: center;
            font-weight: 700;
        }

        h3 {
            font-size: 1.8em;
            margin-bottom: 20px;
            font-weight: 600;
        }

        p {
            margin-bottom: 1.2em;
            color: var(--text-color-medium);
            transition: color 0.5s ease; /* Smooth theme transition */
        }

        a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        a:hover {
            color: var(--secondary-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--section-padding-horizontal);
        }

        .section {
            padding: var(--section-padding-vertical) 0;
            text-align: center;
        }

        /* --- Header/Navigation --- */
        .header {
            background-color: var(--surface-color); /* Header background */
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            position: static;
            width: 100%;
            z-index: 1000;
            transition: background-color 0.5s ease, box-shadow 0.5s ease; /* Smooth theme transition */
        }
        body.dark-theme .header {
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.6); /* Darker shadow in dark mode */
        }


        .header .container {
             display: flex;
             justify-content: space-between;
             align-items: center;
             flex-wrap: wrap;
        }

        .header img {
            max-width: 160px;
            height: auto;
            display: block;
            margin: 0;
        }

        .nav {
            margin-top: 0;
            display: flex;
            align-items: center;
        }

        .nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .nav li {
            margin-left: 30px;
        }

        .nav a {
            color: var(--text-color-medium); /* Nav links color */
            font-family: 'Lato', sans-serif;
            font-weight: 600;
            font-size: 1.1em;
            padding: 5px 0;
            position: relative;
            transition: color 0.5s ease; /* Smooth theme transition */
        }

        .nav a::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 0;
            height: 2px;
            background-color: var(--secondary-color); /* Accent underline */
            transition: width 0.3s ease-in-out, background-color 0.5s ease; /* Smooth theme transition */
        }

        .nav a:hover::after {
            width: 100%;
        }

        /* Cart Icon in Header */
        .cart-icon-container {
            margin-left: 30px;
            position: relative;
            cursor: pointer;
            color: var(--text-color-medium); /* Icon color */
            font-size: 1.5em;
            transition: color 0.3s ease;
        }

        .cart-icon-container:hover {
            color: var(--primary-color); /* Hover color */
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #e74c3c; /* Red remains visible */
            color: white;
            font-size: 0.7em;
            font-weight: 700;
            border-radius: 50%;
            padding: 2px 6px;
            line-height: 1;
            min-width: 10px;
            text-align: center;
        }

         /* Theme Switch Styling */
         .theme-switch-wrapper {
             display: flex;
             align-items: center;
             margin-left: 20px; /* Space from cart */
         }

         .theme-switch {
             position: relative;
             display: inline-block;
             width: 40px;
             height: 24px;
             cursor: pointer;
         }

         .theme-switch input {
             opacity: 0;
             width: 0;
             height: 0;
         }

         .slider {
             position: absolute;
             top: 0;
             left: 0;
             right: 0;
             bottom: 0;
             background-color: #ccc;
             transition: 0.4s;
             border-radius: 24px;
         }

         .slider:before {
             position: absolute;
             content: "";
             height: 16px;
             width: 16px;
             left: 4px;
             bottom: 4px;
             background-color: white;
             transition: 0.4s;
             border-radius: 50%;
         }

         input:checked + .slider {
             background-color: var(--primary-color); /* Uses current theme variable */
         }

         input:checked + .slider:before {
             transform: translateX(16px);
         }

         /* Round slider */
         .slider.round {
             border-radius: 24px;
         }

         .slider.round:before {
             border-radius: 50%;
         }


         /* Responsiveness: Adjustments for Header/Navigation */
         @media (max-width: 768px) {
             .header .container {
                 flex-direction: column;
             }
             .header img {
                 margin-bottom: 15px;
             }
             .nav {
                 flex-direction: column;
                 align-items: center;
                 width: 100%;
             }
             .nav ul {
                 flex-direction: column;
                 align-items: center;
                 width: 100%;
                 margin-bottom: 15px;
             }
             .nav li {
                 margin: 10px 0;
                 width: 100%;
                 border-bottom: 1px solid rgba(255, 255, 255, 0.1);
                 padding-bottom: 10px;
             }
             .nav li:last-child {
                 border-bottom: none;
                 padding-bottom: 0;
             }
             .nav a {
                 display: block;
                 text-align: center;
             }
             .cart-icon-container {
                 margin-left: 0;
                 margin-top: 10px;
             }
             .theme-switch-wrapper {
                 margin-left: 0;
                 margin-top: 10px; /* Space below cart icon */
             }
             .header {
                 padding: 15px 0;
             }
         }


        /* --- Hero Section --- */
        .hero {
            position: relative;
            height: 600px;
            /* High-Quality Visuals: Placeholder for your hero background image */
            background: url('YOUR_HERO_IMAGE_URL.jpg') no-repeat center center/cover; /* REMEMBER TO REPLACE THIS URL */
            display: flex;
            align-items: center;
            justify-content: center;
            color: white; /* Text color on the dark overlay */
            overflow: hidden;
            background-attachment: fixed;
            padding: var(--section-padding-vertical) 0;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5); /* Overlay for text readability */
            z-index: 1;
        }
         body.dark-theme .hero::before {
             background: rgba(0, 0, 0, 0.7); /* Darker overlay in dark mode */
         }


        .hero .container {
            position: relative;
            z-index: 2;
            text-align: center;
        }


        .hero .container h1 {
            color: #FFFFFF; /* White heading on overlay */
            font-size: 4em;
            margin-bottom: 20px;
            font-weight: 700;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
        }

        .hero .container p {
            color: rgba(255, 255, 255, 0.9); /* Slightly transparent white text */
            font-size: 1.3em;
            margin-bottom: 30px;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.4);
        }

        .hero-cta-button {
            display: inline-block;
            background-color: var(--button-primary-bg);
            color: var(--button-primary-text);
            padding: 15px 30px;
            font-size: 1.2em;
            font-weight: 700;
            border-radius: 30px; /* Pill shape */
            transition: background-color 0.3s ease, transform 0.2s ease, color 0.3s ease; /* Smooth theme transition */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .hero-cta-button:hover {
             background-color: var(--button-primary-hover-bg);
             color: var(--button-primary-hover-text);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }


        /* --- About Us & Contact Section (Consolidated) --- */
        .about-contact .container {
            text-align: left;
             display: flex;
             flex-wrap: wrap;
             align-items: flex-start;
             gap: 40px;
             justify-content: center;
        }

         .about-content, .contact-info {
             flex: 1;
             min-width: 300px;
         }

        .about-contact h2 {
            text-align: center;
            width: 100%;
            margin-bottom: 50px;
        }

         .about-content h3, .contact-info h3 {
             text-align: left;
             margin-bottom: 20px;
             font-size: 1.7em;
             color: var(--primary-color);
             transition: color 0.5s ease; /* Smooth theme transition */
         }

        .about-contact p {
            font-size: 1.05em;
            margin-bottom: 1.2em;
            color: var(--text-color-medium);
             transition: color 0.5s ease; /* Smooth theme transition */
        }

        .about-contact address {
             font-style: normal;
             margin-top: 15px;
             font-size: 1.05em;
             line-height: 1.7;
             color: var(--text-color-medium);
             margin-bottom: 20px;
             transition: color 0.5s ease; /* Smooth theme transition */
         }

         .contact-info p {
             margin-bottom: 12px;
             color: var(--text-color-medium);
             font-size: 1.05em;
             transition: color 0.5s ease; /* Smooth theme transition */
         }

         .contact-info p i {
             margin-right: 12px;
             color: var(--secondary-color);
             font-size: 1.2em;
             width: 20px;
             text-align: center;
              transition: color 0.5s ease; /* Smooth theme transition */
         }

        /* --- Products/Categories Section --- */
        .products .container {
             /* No grid directly on container anymore */
        }

        /* Grid for Categories AND Products (applied to nested containers) */
        .category-grid,
        .category-products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        /* Style for the Category Cards (clickable products) */
        .product.category-card {
             cursor: pointer;
             transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
             border-color: var(--border-color);
             background-color: var(--surface-color);
             box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .product.category-card:hover {
             transform: translateY(-5px);
             box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
             border-color: var(--secondary-color);
         }

         body.dark-theme .product.category-card {
              box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); /* Darker shadow */
         }
          body.dark-theme .product.category-card:hover {
             box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5); /* Stronger dark shadow */
         }


        .product.category-card img {
            /* Image still zooms, ok */
        }

         /* Style for actual Product Items within a category */
         .category-products-container .product {
             cursor: default;
             transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
             border-color: var(--border-color);
             background-color: var(--surface-color);
              box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
         }

         .category-products-container .product:hover {
             transform: translateY(-4px);
             box-shadow: 0 8px 18px rgba(0, 0, 0, 0.12);
             border-color: var(--secondary-color);
         }
          body.dark-theme .category-products-container .product {
             box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); /* Darker shadow */
          }
           body.dark-theme .category-products-container .product:hover {
             box-shadow: 0 8px 18px rgba(0, 0, 0, 0.4); /* Softer dark shadow */
         }


        .product {
            /* REFINED CARD STYLE */
            border: 1px solid var(--border-color);
            padding: 0;
            text-align: left;
            background-color: var(--surface-color);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
             transition: background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease; /* Smooth theme transition */
        }


        .product img {
            width: 100%;
            height: 280px;
            object-fit: cover;
            margin-bottom: 0;
            border-bottom: 1px solid var(--border-color);
            transition: transform 0.3s ease, border-color 0.5s ease; /* Smooth theme transition */
            cursor: zoom-in;
        }


        .product-info {
            padding: 15px;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            background-color: rgba(255, 255, 255, 0.95); /* Slightly transparent white background */
            position: relative;
            z-index: 2;
            text-align: left;
             transition: background-color 0.5s ease; /* Smooth theme transition */
        }

         /* Dark theme specific adjustment for product info background overlay */
         body.dark-theme .product-info {
             background-color: rgba(40, 40, 40, 0.95); /* Darker transparent background */
         }


        .product-info h3 {
            margin-top: 0;
            margin-bottom: 6px;
            font-size: 1.4em;
            color: var(--primary-color);
            font-weight: 700;
            font-family: 'Lora', serif;
             transition: color 0.5s ease; /* Smooth theme transition */
        }

        .product-info p.product-description {
            font-size: 0.9em;
            color: var(--text-color-secondary);
            margin-bottom: 12px;
            flex-grow: 1;
            line-height: 1.5;
             transition: color 0.5s ease; /* Smooth theme transition */
        }


        .product-price {
            font-size: 1.1em;
            font-weight: 700;
            color: var(--secondary-color); /* Price color */
            margin-bottom: 15px;
            min-height: 1.5em;
             transition: color 0.5s ease; /* Smooth theme transition */
        }

        /* Add to Cart Button */
        .add-to-cart-button {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            background-color: var(--button-primary-bg);
            color: var(--button-primary-text);
            border: none;
            border-radius: 5px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
            text-align: center;
        }

        .add-to-cart-button:hover {
            background-color: var(--button-primary-hover-bg);
            color: var(--button-primary-hover-text);
        }


        /* Clear Calls to Action: WhatsApp button */
        .whatsapp-button {
            display: block;
            width: calc(100% - 0px);
            margin: 0 0 0 0;
            padding: 12px;
            background-color: var(--whatsapp-green);
            color: white;
            text-decoration: none;
            border-radius: 0 0 8px 8px;
            font-size: 1em;
            font-weight: 600;
            letter-spacing: 0.5px;
            box-shadow: none;
            text-align: center;
            transition: background-color 0.3s ease;
        }

        .whatsapp-button i {
            margin-right: 8px;
        }

        .whatsapp-button:hover {
            background-color: var(--whatsapp-green-hover);
            transform: none;
            box-shadow: none;
        }


         /* User-Friendly Navigation: Search function layout */
         .search-container {
             margin-bottom: 30px;
             text-align: center;
         }

         .search-container input {
            width: calc(100% - 40px);
            max-width: 500px;
            padding: 12px 20px;
            border: 1px solid var(--border-color);
            border-radius: 25px;
            font-size: 1em;
            box-sizing: border-box;
            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.1);
            transition: border-color 0.3s ease, box-shadow 0.3s ease, background-color 0.5s ease, color 0.5s ease; /* Smooth theme transition */
            color: var(--text-color-medium);
            background-color: var(--surface-color);
         }
          body.dark-theme .search-container input {
               box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.3); /* Darker shadow */
          }


        .search-container input::placeholder {
             color: var(--text-color-secondary);
         }


        .search-container input:focus {
            border-color: var(--primary-color);
            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.1), 0 0 8px rgba(184, 138, 69, 0.6); /* Gold focus glow */
            outline: none;
        }

         /* Style for the hidden product containers and back button */
         .category-products-container {
             display: none;
             text-align: left;
             margin-top: 30px;
         }

         .category-products-container h3 {
             text-align: center;
             margin-bottom: 30px;
             font-size: 2em;
             color: var(--primary-color);
              transition: color 0.5s ease; /* Smooth theme transition */
         }

         .back-to-categories, .back-to-cart, .back-to-billing {
             display: inline-block;
             margin-bottom: 30px;
             font-size: 1.1em;
             color: var(--text-color-secondary); /* Back links color */
             transition: color 0.3s ease;
             cursor: pointer;
         }

         .back-to-categories i, .back-to-cart i, .back-to-billing i {
             margin-right: 8px;
         }

         .back-to-categories:hover, .back-to-cart:hover, .back-to-billing:hover {
             color: var(--primary-color); /* Hover color */
             text-decoration: underline;
         }


        /* --- Image Modal/Lightbox --- */
        #imageModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }
         body.dark-theme #imageModal {
             background-color: rgba(0, 0, 0, 0.95); /* Darker overlay in dark mode */
         }


        #imageModal span {
            position: absolute;
            top: 20px;
            right: 30px;
            font-size: 40px;
            color: white;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        #imageModal span:hover {
            color: var(--secondary-color);
        }

        #modalImage {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
         body.dark-theme #modalImage {
             box-shadow: 0 0 40px rgba(0, 0, 0, 0.9); /* Stronger shadow in dark mode */
         }


         /* --- Cart Modal Styling --- */
         #cartModal {
             display: none;
             position: fixed;
             z-index: 10000;
             left: 0;
             top: 0;
             width: 100%;
             height: 100%;
             overflow: auto;
             background-color: rgba(0, 0, 0, 0.6);
             justify-content: center;
             align-items: center;
         }
         body.dark-theme #cartModal {
             background-color: rgba(0, 0, 0, 0.8); /* Darker dim background */
         }


         .cart-modal-content {
             background-color: var(--surface-color);
             margin: auto;
             padding: 30px;
             border-radius: 10px;
             width: 90%;
             max-width: 600px;
             box-shadow: 0 5px 15px rgba(0,0,0,0.3);
             position: relative;
             max-height: 80vh;
             overflow-y: auto;
             text-align: left;
             transition: background-color 0.5s ease, box-shadow 0.5s ease; /* Smooth theme transition */
         }
         body.dark-theme .cart-modal-content {
             box-shadow: 0 5px 20px rgba(0,0,0,0.5); /* Darker shadow */
         }


         .cart-modal-content h2 {
             text-align: center;
             margin-top: 0;
             margin-bottom: 20px;
             color: var(--primary-color);
             transition: color 0.5s ease; /* Smooth theme transition */
         }

         .cart-modal-content .close {
             position: absolute;
             top: 15px;
             right: 25px;
             color: #aaa;
             font-size: 35px;
             font-weight: bold;
             cursor: pointer;
             transition: color 0.3s ease;
         }

         .cart-modal-content .close:hover,
         .cart-modal-content .close:focus {
             color: #333;
         }
          body.dark-theme .cart-modal-content .close {
             color: #b0b0b0; /* Lighter grey */
          }
           body.dark-theme .cart-modal-content .close:hover,
           body.dark-theme .cart-modal-content .close:focus {
               color: #e0e0e0; /* Even lighter grey */
           }


         #cartItemsList {
             list-style: none;
             padding: 0;
             margin: 0;
         }

         #cartItemsList li {
             border-bottom: 1px solid var(--border-color);
             padding: 15px 0;
             display: flex;
             justify-content: space-between;
             align-items: center;
             font-size: 1.1em;
             color: var(--text-color-medium);
             transition: color 0.5s ease, border-color 0.5s ease; /* Smooth theme transition */
         }

         #cartItemsList li:last-child {
             border-bottom: none;
         }

         .item-details .item-name {
             font-weight: 600;
             color: var(--text-color-dark);
             transition: color 0.5s ease; /* Smooth theme transition */
         }

         .item-details .item-quantity {
             font-size: 0.9em;
             color: var(--text-color-secondary);
             transition: color 0.5s ease; /* Smooth theme transition */
         }

         .item-details .item-price {
              color: var(--primary-color);
              transition: color 0.5s ease; /* Smooth theme transition */
         }


         .remove-item {
             background-color: #e74c3c; /* Red color */
             color: white;
             border: none;
             border-radius: 4px;
             padding: 5px 10px;
             cursor: pointer;
             font-size: 0.9em;
             transition: background-color 0.3s ease;
         }

         .remove-item:hover {
             background-color: #c0392b; /* Darker red */
         }

         .cart-total {
             margin-top: 20px;
             text-align: right;
             font-size: 1.3em;
             font-weight: 700;
             color: var(--text-color-dark);
             padding-top: 15px;
             border-top: 1px solid var(--border-color);
             transition: color 0.5s ease, border-color 0.5s ease; /* Smooth theme transition */
         }
          body.dark-theme .cart-total {
              color: var(--primary-color); /* Total color in dark mode */
          }


         .checkout-button {
             display: block;
             width: 100%;
             padding: 12px;
             margin-top: 20px;
             background-color: var(--button-primary-bg);
             color: var(--button-primary-text);
             border: none;
             border-radius: 5px;
             font-size: 1.1em;
             font-weight: 700;
             text-align: center;
             cursor: pointer;
             transition: background-color 0.3s ease, color 0.3s ease;
         }

         .checkout-button:hover {
             background-color: var(--button-primary-hover-bg);
             color: var(--button-primary-hover-text);
         }

         /* Styling for empty cart message */
         #emptyCartMessage {
            text-align: center;
            color: var(--text-color-secondary);
            margin-top: 20px;
            font-size: 1.1em;
             transition: color 0.5s ease; /* Smooth theme transition */
         }


         /* --- Billing Section Styling --- */
         #billingSection {
             display: none;
             text-align: left;
             margin-top: 40px;
             padding-top: 40px;
             border-top: 1px solid var(--border-color);
             transition: border-top 0.5s ease; /* Smooth theme transition */
         }

         #billingSection h2 {
             text-align: center;
             margin-bottom: 30px;
         }

         #billingForm {
             /* Initially visible */
         }

          #billingForm label {
             display: block;
             margin-bottom: 8px;
             font-weight: 600;
             color: var(--text-color-dark);
             transition: color 0.5s ease; /* Smooth theme transition */
         }
         body.dark-theme #billingForm label {
             color: var(--text-color-medium);
         }


         #billingForm input[type="text"],
         #billingForm input[type="email"],
         #billingForm input[type="tel"],
         #billingForm textarea {
             width: calc(100% - 22px);
             padding: 10px;
             margin-bottom: 20px;
             border: 1px solid var(--border-color);
             border-radius: 4px;
             font-size: 1em;
             box-sizing: border-box;
             transition: border-color 0.3s ease, background-color 0.5s ease, color 0.5s ease; /* Smooth theme transition */
             color: var(--text-color-medium);
             background-color: var(--surface-color);
         }

          /* Style for invalid input */
          #billingForm input:invalid {
              border-color: #dc3545; /* Red */
          }

           /* Optional: Style for valid input (can be annoying) */
           /* #billingForm input:valid {
              border-color: #28a745; Green
           } */


         #billingForm input[type="text"]:focus,
         #billingForm input[type="email"]:focus,
         #billingForm input[type="tel"]:focus,
         #billingForm textarea:focus {
             border-color: var(--primary-color);
             outline: none;
         }

         #orderSummaryReview {
             margin-bottom: 30px;
             padding: 20px;
             border: 1px solid var(--border-color);
             border-radius: 8px;
             background-color: var(--surface-color);
              transition: background-color 0.5s ease, border-color 0.5s ease; /* Smooth theme transition */
         }

         #orderSummaryReview h3 {
             margin-top: 0;
             margin-bottom: 15px;
             font-size: 1.5em;
             text-align: center;
             color: var(--primary-color);
              transition: color 0.5s ease; /* Smooth theme transition */
         }

         #orderSummaryReview ul {
             list-style: none;
             padding: 0;
             margin: 0;
         }

         #orderSummaryReview li {
             border-bottom: 1px dashed var(--border-color);
             padding: 10px 0;
             font-size: 1em;
             color: var(--text-color-medium);
             display: flex;
             justify-content: space-between;
              transition: color 0.5s ease, border-color 0.5s ease; /* Smooth theme transition */
         }

         #orderSummaryReview li:last-child {
             border-bottom: none;
         }

         #orderSummaryReview .item-name {
             font-weight: 600;
             flex-grow: 1;
             margin-right: 10px;
             color: var(--text-color-dark);
              transition: color 0.5s ease; /* Smooth theme transition */
         }
          body.dark-theme #orderSummaryReview .item-name {
              color: var(--text-color-medium);
          }


          #orderSummaryReview .item-price {
             font-weight: 600;
             text-align: right;
             color: var(--secondary-color);
              transition: color 0.5s ease; /* Smooth theme transition */
          }
           body.dark-theme #orderSummaryReview .item-price {
               color: var(--primary-color);
           }


         /* Styles for the total, discount, and final total in review */
          .total-line {
              margin-top: 10px;
              padding-top: 10px;
              border-top: 1px solid var(--border-color);
              text-align: right;
               transition: border-top 0.5s ease; /* Smooth theme transition */
          }

          .total-line span {
              display: inline-block;
              min-width: 100px;
          }

          .total-line strong {
              font-size: 1.1em;
              color: var(--text-color-dark);
               transition: color 0.5s ease; /* Smooth theme transition */
          }
          body.dark-theme .total-line strong {
               color: var(--text-color-medium);
          }


           .discount-line {
               color: #28a745; /* Green for discount */
               font-weight: 600;
               margin-top: 5px;
               text-align: right;
           }
            body.dark-theme .discount-line {
                color: #2ecc71; /* Adjusted green for dark mode */
            }


          .final-total-line {
              margin-top: 10px;
              padding-top: 10px;
              border-top: 2px solid var(--primary-color);
              font-size: 1.3em;
              font-weight: 700;
              color: var(--secondary-color);
              text-align: right;
               transition: color 0.5s ease, border-top 0.5s ease; /* Smooth theme transition */
          }
           body.dark-theme .final-total-line {
               color: var(--primary-color); /* Gold for final total in dark mode */
               border-top-color: var(--secondary-color); /* Navy border for contrast */
           }


         /* Coupon Section Styling */
          .coupon-section {
              margin-top: 20px;
              margin-bottom: 30px;
              padding: 15px;
              border: 1px solid var(--border-color);
              border-radius: 8px;
              background-color: #f9f9f9; /* Light background for contrast */
              display: flex;
              flex-wrap: wrap;
              gap: 10px;
              align-items: center;
               transition: background-color 0.5s ease, border-color 0.5s ease; /* Smooth theme transition */
          }
           body.dark-theme .coupon-section {
               background-color: #3a3a3a; /* Slightly darker background */
           }


           .coupon-section label {
               margin-bottom: 0;
               margin-right: 10px;
               font-weight: 600;
               color: var(--text-color-dark);
               transition: color 0.5s ease; /* Smooth theme transition */
           }
            body.dark-theme .coupon-section label {
                color: var(--text-color-medium);
            }


          .coupon-section input[type="text"] {
              flex-grow: 1;
              min-width: 150px;
              margin-bottom: 0;
              padding: 8px;
              border-radius: 4px;
              border: 1px solid var(--border-color);
              transition: border-color 0.3s ease, background-color 0.5s ease, color 0.5s ease; /* Smooth theme transition */
              color: var(--text-color-medium);
              background-color: var(--surface-color);
          }

          .coupon-section button {
              padding: 8px 15px;
              background-color: var(--button-secondary-bg); /* Use secondary button style */
              color: var(--button-secondary-text);
              border: none;
              border-radius: 4px;
              font-weight: 600;
              cursor: pointer;
              transition: background-color 0.3s ease, color 0.3s ease;
          }

          .coupon-section button:hover {
              background-color: var(--button-secondary-hover-bg);
              color: var(--button-secondary-hover-text);
          }


          #couponMessage {
              width: 100%;
              margin-top: 10px;
              font-size: 0.9em;
              text-align: center;
          }

          #couponMessage.success {
              color: #28a745; /* Green */
          }
           body.dark-theme #couponMessage.success {
               color: #2ecc71; /* Adjusted green */
           }

           #couponMessage.error {
               color: #dc3545; /* Red */
           }


         /* Styling for Payment Info Section */
         #paymentInfo {
             display: none;
             margin-top: 30px;
             padding-top: 30px;
             border-top: 1px dashed var(--border-color);
             text-align: center;
             transition: border-top 0.5s ease; /* Smooth theme transition */
         }

         #paymentInfo h3 {
              text-align: center;
             margin-bottom: 20px;
             color: var(--text-color-dark);
              transition: color 0.5s ease; /* Smooth theme transition */
             font-size: 1.7em;
         }
          body.dark-theme #paymentInfo h3 {
              color: var(--text-color-medium);
          }


          #paymentInfo p {
              font-size: 1.1em;
              margin-bottom: 15px;
              color: var(--text-color-medium);
               transition: color 0.5s ease; /* Smooth theme transition */
          }

          #paymentInfo .upi-details {
              font-size: 1.3em;
              font-weight: 700;
              color: var(--primary-color);
              margin-bottom: 20px;
              word-break: break-all;
              transition: color 0.5s ease; /* Smooth theme transition */
          }

          #paymentInfo img {
              max-width: 250px;
              height: auto;
              margin-bottom: 20px;
              border: 1px solid var(--border-color);
              padding: 10px;
              background-color: white; /* Keep white background for QR code contrast */
              box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
               transition: border-color 0.5s ease; /* Smooth theme transition */
          }

         body.dark-theme #paymentInfo img {
             border-color: var(--border-color);
             box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3); /* Darker shadow */
         }


          #paymentInfo .payment-instruction {
              font-size: 1em;
              color: var(--text-color-secondary);
              margin-top: 15px;
              line-height: 1.6;
               transition: color 0.5s ease; /* Smooth theme transition */
          }


         /* Buttons Container */
         .billing-buttons {
             display: flex;
             gap: 20px;
             margin-top: 20px;
         }

         .billing-buttons button,
         .billing-buttons a {
             flex: 1;
             display: block;
             padding: 12px;
             border-radius: 5px;
             font-size: 1.1em;
             font-weight: 700;
             text-align: center;
             cursor: pointer;
             transition: background-color 0.3s ease, color 0.3s ease;
             text-decoration: none;
             box-sizing: border-box;
         }


          .billing-buttons #proceedToPaymentButton,
          .billing-buttons #submitOrderButton {
              background-color: var(--button-primary-bg);
              color: var(--button-primary-text);
          }

          .billing-buttons #proceedToPaymentButton:hover,
          .billing-buttons #submitOrderButton:hover {
              background-color: var(--button-primary-hover-bg);
              color: var(--button-primary-hover-text);
          }

          .billing-buttons .whatsapp-billing-button {
              background-color: var(--whatsapp-green);
              color: white;
              border: none;
          }

          .billing-buttons .whatsapp-billing-button:hover {
              background-color: var(--whatsapp-green-hover);
          }

          .billing-buttons .whatsapp-billing-button i {
              margin-right: 8px;
          }


         /* Responsive adjustment for buttons */
         @media (max-width: 600px) {
              .billing-buttons {
                  flex-direction: column;
                  gap: 10px;
              }
               .coupon-section {
                   flex-direction: column;
                   align-items: stretch;
               }
                .coupon-section label {
                   margin-right: 0;
                   margin-bottom: 5px;
                }
                 .coupon-section input[type="text"] {
                     width: 100%;
                     min-width: auto;
                 }
         }


        /* --- Footer --- */
        .footer {
            background-color: var(--surface-color);
            color: var(--footer-text-color);
            text-align: center;
            padding: 40px 0;
            margin-top: 60px;
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.3);
            font-size: 0.9em;
            transition: background-color 0.5s ease, color 0.5s ease, box-shadow 0.5s ease; /* Smooth theme transition */
        }
        body.dark-theme .footer {
             box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.6); /* Darker shadow */
        }


        .social-links {
            margin-top: 0;
            margin-bottom: 0;
        }

        .social-links a {
            display: inline-block;
            margin: 0 15px;
            color: var(--primary-color);
            font-size: 32px;
            transition: color 0.3s ease, transform 0.3s ease;
        }

        .social-links a:hover {
            color: var(--text-color-dark);
        }
        body.dark-theme .social-links a:hover {
            color: var(--text-color-medium);
        }


        /* --- Responsive Adjustments --- */
        @media (max-width: 1024px) {
             .section h2 {
                 font-size: 2.4em;
             }
             .hero {
                 height: 500px;
             }
             .hero .container h1 {
                 font-size: 3em;
             }
             .hero .container p {
                 font-size: 1.2em;
             }
              /* Grids adapt */
             .category-grid,
             .category-products-grid {
                grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
                gap: 25px;
            }
             .product img {
                 height: 250px;
             }
             .product-info {
                 padding: 12px;
             }
             .product-info h3 {
                 font-size: 1.4em;
                  margin-bottom: 6px;
             }
             .product-info p.product-description {
                 font-size: 0.9em;
                 margin-bottom: 12px;
             }
              .product-price {
                 font-size: 1.05em;
                 margin-bottom: 12px;
             }
              .add-to-cart-button, .whatsapp-button {
                 font-size: 0.95em;
                 padding: 8px;
             }
             .whatsapp-button {
                 margin-top: 8px;
             }
             .section {
                 padding: 80px 0;
             }
             .category-products-container h3 {
                 font-size: 1.8em;
             }
             .cart-modal-content {
                 padding: 20px;
             }
              #cartItemsList li {
                 font-size: 1em;
                 padding: 10px 0;
             }
              .remove-item {
                 padding: 3px 8px;
                 font-size: 0.85em;
             }
              .cart-total {
                 font-size: 1.2em;
             }
             #billingSection h2 {
                 font-size: 2em;
             }
             #orderSummaryReview h3 {
                 font-size: 1.3em;
             }
              #orderSummaryReview li {
                  font-size: 0.95em;
              }
               .total-line strong,
               .final-total-line {
                   font-size: 1em;
               }
               .total-line span,
               .discount-line span,
               .final-total-line span {
                   min-width: 80px;
               }

         }

        @media (max-width: 768px) {
             .section {
                 padding: 60px 0;
             }
            .section h2 {
                font-size: 2em;
            }
             .hero {
                 height: 400px;
             }
             .hero .container h1 {
                 font-size: 2.5em;
             }
             .hero .container p {
                 font-size: 1.1em;
             }
             .hero-cta-button {
                 padding: 12px 25px;
                 font-size: 1.1em;
             }
             .about-contact .container {
                 flex-direction: column;
                 gap: 30px;
             }
             .about-contact h2, .about-content h3, .contact-info h3 {
                 text-align: center;
             }
             .about-contact p, .about-contact address, .contact-info p {
                 font-size: 1em;
             }
              /* Grids adapt */
             .category-grid,
             .category-products-grid {
                grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
                gap: 20px;
            }
             .product img {
                 height: 180px;
             }
             .product-info {
                 padding: 10px;
             }
             .product-info h3 {
                 font-size: 1.3em;
                  margin-bottom: 5px;
             }
             .product-info p.product-description {
                 font-size: 0.85em;
                 margin-bottom: 10px;
             }
             .product-price {
                 font-size: 1em;
                 margin-bottom: 10px;
             }
             .add-to-cart-button, .whatsapp-button {
                font-size: 0.95em;
                padding: 8px;
             }
            .whatsapp-button {
                 margin-top: 8px;
            }
             .social-links a {
                font-size: 28px;
                margin: 0 12px;
            }
             .footer {
                padding: 30px 0;
             }
             .category-products-container h3 {
                 font-size: 1.6em;
             }
             .cart-modal-content {
                 padding: 20px;
             }
              #cartItemsList li {
                 font-size: 1em;
                 padding: 10px 0;
             }
              .remove-item {
                 padding: 3px 8px;
                 font-size: 0.85em;
             }
              .cart-total {
                 font-size: 1.2em;
             }
              #billingSection h2 {
                 font-size: 1.8em;
             }
              #orderSummaryReview h3 {
                  font-size: 1.2em;
              }
              #orderSummaryReview li {
                  font-size: 0.9em;
              }
               .total-line strong,
               .final-total-line {
                   font-size: 0.95em;
               }
               .total-line span,
               .discount-line span,
               .final-total-line span {
                   min-width: 70px;
               }
               #billingForm input, #billingForm textarea {
                  padding: 8px;
                  margin-bottom: 15px;
               }
               #billingForm label {
                  margin-bottom: 5px;
               }
         }

         @media (max-width: 480px) {
              .section {
                 padding: 40px 0;
             }
             .section h2 {
                 font-size: 1.8em;
             }
             .hero {
                 height: 350px;
             }
             .hero .container h1 {
                 font-size: 2em;
             }
             .hero .container p {
                 font-size: 0.95em;
             }
             .hero-cta-button {
                 padding: 10px 20px;
                 font-size: 1em;
             }
             .about-contact .container {
                gap: 20px;
             }
             .about-contact p, .about-contact address, .contact-info p {
                 font-size: 0.95em;
             }
              /* Grids stack to 1 column on smallest screens */
             .category-grid,
             .category-products-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
             .product img {
                height: 160px;
            }
             .product-info {
                 padding: 8px;
             }
             .product-info h3 {
                 font-size: 1.2em;
                 margin-bottom: 4px;
             }
             .product-info p.product-description {
                 font-size: 0.8em;
                 margin-bottom: 8px;
             }
             .product-price {
                 font-size: 0.95em;
                 margin-bottom: 8px;
             }
             .add-to-cart-button, .whatsapp-button {
                font-size: 0.9em;
                padding: 6px;
             }
            .whatsapp-button {
                 margin-top: 6px;
            }
             .social-links a {
                font-size: 26px;
                margin: 0 8px;
            }
             .footer {
                padding: 25px 0;
             }
             .category-products-container h3 {
                 font-size: 1.4em;
             }
              .cart-modal-content {
                 padding: 15px;
             }
              #cartItemsList li {
                 font-size: 0.95em;
                 padding: 8px 0;
             }
              .remove-item {
                 padding: 2px 6px;
                 font-size: 0.8em;
             }
              .cart-total {
                 font-size: 1.1em;
             }
              .checkout-button {
                font-size: 1em;
                padding: 10px;
              }
               .total-line span,
               .discount-line span,
               .final-total-line span {
                   min-width: 50px;
               }
         }


    </style>
</head>
<body>

    <header class="header">
        <div class="container">
            <img src="GridArt_20250516_180656516.png" alt="J.K Gems Logo">
            <nav class="nav">
                <ul>
                    <li><a href="#about">About & Visit Us</a></li>
                    <li><a href="#products">Categories</a></li>
                </ul>
                 <div class="theme-switch-wrapper">
                    <label class="theme-switch" for="theme-checkbox">
                        <input type="checkbox" id="theme-checkbox" />
                        <div class="slider round"></div>
                    </label>
                </div>
                 <div class="cart-icon-container" id="cartIcon">
                     <i class="fas fa-shopping-cart"></i>
                     <span class="cart-count" id="cartCount">0</span>
                 </div>
            </nav>
        </div>
    </header>

    <section class="hero">
        <div class="hero-content">
            <div class="container">
                <h1>Exquisite Gemstones & Spiritual Treasures</h1>
                <p>Discover the perfect blend of beauty, authenticity, and spiritual energy at J.K Gems.</p>
                <a href="#products" class="hero-cta-button">Explore Categories</a>
            </div>
        </div>
    </section>

    <section id="about" class="section about-contact">
        <div class="container">
            <h2>About J.K Gems & Visit Us</h2>
            <div class="about-content">
                <h3>Our Story</h3>
                <p>J.K Gems is a well-known and trusted firm, serving customers with exquisite gemstones and spiritual products since 1965. Founded on principles of quality, authenticity, and integrity, we have built a reputation as a cornerstone in Junagadh's Soni Bajar.</p>
                <p>For generations, we have been dedicated to sourcing the finest gemstones and authentic spiritual items, offering expert guidance and personalized service to our valued customers. Our legacy is built on trust, and our commitment to providing genuine products remains unwavering.</p>
            </div>

            <div class="contact-info">
                 <h3>Contact & Location</h3>
                 <p><i class="fas fa-map-marker-alt"></i> Jk gems<br>Balakrishna market, Haveli gali<br>Soni bajar, Junagadh<br>Gujarat 362001</p>
                 <p><i class="fas fa-phone"></i> +91 9723197899</p>
                 <p><i class="far fa-clock"></i> Business Hours: 10 am to 3 pm and 4 pm to 9 pm</p>
                 <p>You can also inquire directly via WhatsApp using the buttons on our product listings below.</p>
            </div>
        </div>
    </section>

    <section id="products" class="section products">
        <div class="container">
             <h2 id="products-heading">Our Categories</h2>
             <div class="search-container">
                 <input type="text" id="searchInput" onkeyup="searchItems()" placeholder="Search Categories or Products...">
             </div>

            <div class="category-grid" id="categoryGrid">
                <div class="product category-card" data-category-target="gemstones">
                    <img src="IMG-20250516-WA0015.jpg" alt="Gem stones Category">
                    <div class="product-info">
                        <h3>Gemstones</h3>
                        <p class="product-description">Explore our collection of authentic, high-quality gemstones.</p>
                    </div>
                </div>

                <div class="product category-card" data-category-target="rudraksh">
                    <img src="IMG-20250516-WA0003.jpg" alt="Rudraksh Category">
                     <div class="product-info">
                        <h3>Rudraksh</h3>
                        <p class="product-description">Discover genuine Rudraksha beads and items for spiritual well-being.</p>
                    </div>
                </div>

                <div class="product category-card" data-category-target="yantra">
                    <img src="IMG-20250516-WA0001.jpg" alt="Yantra Category">
                     <div class="product-info">
                        <h3>Yantra & Spiritual Items</h3>
                        <p class="product-description">Sacred geometric diagrams, Sphatik items, and other spiritual treasures.</p>
                    </div>
                </div>

                 </div>
            <div id="gemstones-products-container" class="category-products-container">
                 <a href="#products" class="back-to-categories"><i class="fas fa-arrow-left"></i> Back to Categories</a>
                 <h3>Gemstones Collection</h3>
                 <div class="category-products-grid">
                     <div class="product">
                         <img src="path/to/your_gemstone_image_1.jpg" alt="Example Gemstone 1"> <div class="product-info">
                             <h3>Example Gemstone 1</h3>
                             <p class="product-description">Brief description of Example Gemstone 1.</p>
                             <p class="product-price">5500.00</p> <button class="add-to-cart-button"
                                     data-product-id="gemstone_ex1"
                                     data-product-name="Example Gemstone 1"
                                     data-product-price="5500"> Add to Cart
                             </button>
                              <a href="https://wa.me/919723197899?text=Hello,%20I'm%20interested%20in%20Example%20Gemstone%201.%20Could%20you%20provide%20more%20details%20and%20pricing?" class="whatsapp-button" target="_blank" aria-label="Inquire about Example Gemstone 1 on WhatsApp"><i class="fab fa-whatsapp"></i> Inquire Now</a>
                         </div>
                     </div>
                     <div class="product">
                         <img src="IMG-20250516-WA0011.jpg" alt="Gemstone Rings"> <div class="product-info">
                             <h3>Gemstone Rings</h3>
                             <p class="product-description">Beautiful rings featuring authentic gemstones for style and astrological benefits.</p>
                             <p class="product-price">999.00</p> <button class="add-to-cart-button"
                                     data-product-id="gemstone_rings_main"
                                     data-product-name="Gemstone Rings"
                                     data-product-price="999"> Add to Cart
                             </button>
                              <a href="https://wa.me/919723197899?text=Hello,%20I'm%20interested%20in%20Gemstone%20Rings.%20Could%20you%20provide%20more%20details%20and%20pricing?" class="whatsapp-button" target="_blank" aria-label="Inquire about Gemstone Rings on WhatsApp"><i class="fab fa-whatsapp"></i> Inquire Now</a>
                         </div>
                     </div>
                      </div>
            </div>

            <div id="rudraksh-products-container" class="category-products-container">
                <a href="#products" class="back-to-categories"><i class="fas fa-arrow-left"></i> Back to Categories</a>
                <h3>Rudraksh Items</h3>
                <div class="category-products-grid">
                     <div class="product">
                         <img src="IMG-20250516-WA0003.jpg" alt="Rudraksh Mala"> <div class="product-info">
                             <h3>Rudraksh Mala</h3>
                             <p class="product-description">Genuine Rudraksha beads for spiritual connection and well-being.</p>
                             <p class="product-price">599.00</p> <button class="add-to-cart-button"
                                     data-product-id="rudraksh_mala_main"
                                     data-product-name="Rudraksh Mala" data-product-price="599"> Add to Cart
                             </button>
                              <a href="https://wa.me/919723197899?text=Hello,%20I'm%20interested%20in%20Rudraksh%20Mala.%20Could%20you%20provide%20more%20details%20and%20pricing?" class="whatsapp-button" target="_blank" aria-label="Inquire about Rudraksh Mala on WhatsApp"><i class="fab fa-whatsapp"></i> Inquire Now</a>
                         </div>
                     </div>
                     <div class="product">
                         <img src="IMG-20250516-WA0016.jpg" alt="Rudraksh Bracelet"> <div class="product-info">
                             <h3>Rudraksh Bracelet</h3>
                             <p class="product-description">Wear the spiritual energy with authentic Rudraksh bracelets.</p>
                             <p class="product-price">5999.00</p> <button class="add-to-cart-button"
                                     data-product-id="rudraksh_bracelet_main"
                                     data-product-name="Rudraksh Bracelet"
                                     data-product-price="5999"> Add to Cart
                             </button>
                              <a href="https://wa.me/919723197899?text=Hello,%20I'm%20interested%20in%20Rudraksh%20Bracelet.%20Could%20you%20provide%20more%20details%20and%20pricing?" class="whatsapp-button" target="_blank" aria-label="Inquire about Rudraksh Bracelet on WhatsApp"><i class="fab fa-whatsapp"></i> Inquire Now</a>
                         </div>
                     </div>
                      </div>
            </div>

             <div id="yantra-products-container" class="category-products-container">
                <a href="#products" class="back-to-categories"><i class="fas fa-arrow-left"></i> Back to Categories</a>
                <h3>Yantra & Spiritual Collection</h3>
                <div class="category-products-grid">
                     <div class="product">
                         <img src="IMG-20250516-WA0001.jpg" alt="Yantra"> <div class="product-info">
                             <h3>Yantra</h3>
                             <p class="product-description">Sacred geometric diagrams for meditation and energy focusing.</p>
                             <p class="product-price">999.00</p> <button class="add-to-cart-button"
                                     data-product-id="yantra_main"
                                     data-product-name="Yantra"
                                     data-product-price="999"> Add to Cart
                             </button>
                              <a href="https://wa.me/919723197899?text=Hello,%20I'm%20interested%20in%20Yantra.%20Could%20you%20provide%20more%20details%20and%20pricing?" class="whatsapp-button" target="_blank" aria-label="Inquire about Yantra on WhatsApp"><i class="fab fa-whatsapp"></i> Inquire Now</a>
                         </div>
                     </div>
                      <div class="product">
                         <img src="61Fg6DsA4iL._AC_UF894,1000_QL80_.jpg" alt="Sphatik Shree Yantra"> <div class="product-info">
                             <h3>Sphatik Shree Yantra</h3>
                             <p class="product-description">Clear quartz Shree Yantra for purity, prosperity, and positive energy.</p>
                              <p class="product-price">999.00</p> <button class="add-to-cart-button"
                                     data-product-id="sphatik_yantra_main"
                                     data-product-name="Sphatik Shree Yantra"
                                     data-product-price="999"> Add to Cart
                             </button>
                             <a href="https://wa.me/919723197899?text=Hello,%20I'm%20interested%20in%20Sphatik%20Shree%20Yantra.%20Could%20you%20provide%20more%20details%20and%20pricing?" class="whatsapp-button" target="_blank" aria-label="Inquire about Sphatik Shree Yantra on WhatsApp"><i class="fab fa-whatsapp"></i> Inquire Now</a>
                         </div>
                     </div>
                      </div>
            </div>
            </div>
    </section>

    <div id="cartModal">
        <div class="cart-modal-content">
            <span class="close" id="closeCartModal"></span>
            <h2>Your Cart</h2>
            <div id="emptyCartMessage">Your cart is empty.</div>
            <ul id="cartItemsList">
                </ul>
            <div class="cart-total" id="cartTotal"></div>
            <button class="checkout-button" id="checkoutButton">Proceed to Inquiry</button>
        </div>
    </div>

    <section id="billingSection" class="section">
         <div class="container">
             <a href="#" class="back-to-cart"><i class="fas fa-arrow-left"></i> Back to Cart</a>
             <h2>Order Inquiry & Payment</h2>

             <div id="orderSummaryReview">
                 <h3>Order Summary</h3>
                 <ul id="reviewItemsList">
                     </ul>
                 <div class="total-line">Subtotal: <span id="reviewSubtotal"></span></div>
                  <div class="discount-line" id="reviewDiscountLine" style="display: none;">Discount: <span id="reviewDiscount"></span></div>
                  <div class="final-total-line">Total: <span id="reviewFinalTotal"></span></div>

             </div>

             <div class="coupon-section" id="couponSection">
                 <label for="couponCode">Coupon Code:</label>
                 <input type="text" id="couponCode" placeholder="Enter coupon code">
                 <button type="button" id="applyCouponButton">Apply Coupon</button>
                 <div id="couponMessage"></div>
             </div>

             <form id="billingForm" action="https://formsubmit.co/Gauravraningagoldjewellery@gmail.com" method="POST">
                 <input type="hidden" name="_subject" id="emailSubject" value="J.K Gems Website Order Inquiry">
                 <input type="hidden" name="_template" value="box">
                 <input type="hidden" name="_next" value="YOUR_THANK_YOU_PAGE_URL_HERE">
                 <input type="text" name="_honeypot" style="display:none">


                 <div id="billingInputs">
                      <label for="customer_name">Full Name:</label>
                      <input type="text" id="customer_name" name="Name" required pattern="[A-Za-z---\s'-]+" title="Enter your full name (letters, spaces, hyphens, or apostrophes only)">

                     <label for="customer_email">Email (Optional):</label>
                     <input type="email" id="customer_email" name="Email">

                     <label for="customer_phone">Phone/WhatsApp Number:</label>
                     <input type="tel" id="customer_phone" name="Phone" required pattern="[\d\s\-\(\)+]+" title="Enter a valid phone number (digits, spaces, hyphens, parentheses, or plus sign allowed)">

                     <label for="customer_address">Shipping Address:</label>
                     <textarea id="customer_address" name="Address" rows="4" required></textarea>
                 </div>


                 <input type="hidden" name="Order Details" id="orderCartDetails">
                 <input type="hidden" name="_parsed_order_details" id="_parsedOrderDetails">
                 <input type="hidden" name="Discount Applied" id="discountApplied">
                 <input type="hidden" name="Final Total" id="finalOrderTotal">
                 <input type="hidden" name="UPI ID Shown" value="gauravraninga23@okhdfcbank">
                 <input type="hidden" name="Payment Instruction Shown" value="Please complete the payment via UPI using the details provided. Your order is confirmed only after payment is received. You will receive a confirmation email once payment is verified.">


                 <div id="paymentInfo">
                     <h3>Complete Your Payment via UPI</h3>
                     <p>Please transfer the total amount to the UPI ID below:</p>
                     <div class="upi-details">gauravraninga23@okhdfcbank</div>
                     <p>Scan the QR code to pay:</p>
                     <img src="IMG-20250517-WA0001.jpg" alt="UPI QR Code">
                     <p class="payment-instruction">
                         <strong>Important:</strong> Your order inquiry has been received. Your order will be confirmed only *after* the payment is successfully received. Please complete the UPI payment now. You will receive a confirmation email once your payment is verified.
                     </p>
                 </div>

                 <div class="billing-buttons">
                      <button type="button" id="proceedToPaymentButton">Proceed to Payment</button>
                      <button type="submit" id="submitOrderButton" style="display: none;">Submit Inquiry / Payment Made</button>
                 </div>
                 <a href="https://wa.me/919723197899?text=Hello,%20I have a general query regarding my order inquiry." class="whatsapp-billing-button" target="_blank" aria-label="WhatsApp Query"><i class="fab fa-whatsapp"></i> WhatsApp Query</a>

             </form>
         </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="social-links">
                <a href="https://www.instagram.com/j_k_gems" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="https://www.facebook.com/YOUR_FACEBOOK_PAGE_ID" target="_blank" aria-label="Facebook"><i class="fab fa-facebook"></i></a> <a href="https://youtube.com/@jkgems-td3et?si=Ne4JWKic5aeZfBTa" target="_blank" aria-label="YouTube"><i class="fab fa-youtube"></i></a> </div>
             <p> 2025 J.K Gems. All rights reserved.</p>
        </div>
    </footer>

    <div id="imageModal">
        <span class="close"></span>
        <img src="" id="modalImage" alt="Enlarged product image">
    </div>

    <script>
        // --- Theme Switching Functionality ---
        const themeCheckbox = document.getElementById('theme-checkbox');
        const bodyElement = document.body;

        // Function to apply the saved theme preference on load
        function applyThemePreference() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                bodyElement.classList.add('dark-theme');
                themeCheckbox.checked = true; // Set checkbox state
            } else {
                bodyElement.classList.remove('dark-theme');
                themeCheckbox.checked = false; // Set checkbox state
            }
        }

        // Event listener for the theme switch checkbox
        themeCheckbox.addEventListener('change', function() {
            if (this.checked) {
                bodyElement.classList.add('dark-theme');
                localStorage.setItem('theme', 'dark'); // Save preference
            } else {
                bodyElement.classList.remove('dark-theme');
                localStorage.setItem('theme', 'light'); // Save preference
            }
        });


        // --- Category/Product View Switching ---
        const categoryGrid = document.getElementById('categoryGrid');
        const productContainers = document.querySelectorAll('.category-products-container');
        const productsHeading = document.getElementById('products-heading');
        const searchInput = document.getElementById('searchInput');
        const categoryCards = document.querySelectorAll('.category-card'); // Select these once
        const backButtons = document.querySelectorAll('.back-to-categories');
        const billingSection = document.getElementById('billingSection'); // Reference to the billing section
        const billingInputs = document.getElementById('billingInputs'); // Container for billing form inputs
        const paymentInfoDiv = document.getElementById('paymentInfo'); // Container for payment info
        const proceedToPaymentButton = document.getElementById('proceedToPaymentButton'); // Button to show payment info
        const submitOrderButton = document.getElementById('submitOrderButton'); // Button to submit the form
        const backToCartButton = document.querySelector('.back-to-cart');


        // Function to show only the category grid
        function showCategoryGrid() {
            productsHeading.textContent = 'Our Categories';
            searchInput.placeholder = 'Search Categories...';
            searchInput.style.display = 'block'; // Show search bar
            categoryGrid.style.display = 'grid'; // Show the category grid
            productContainers.forEach(container => {
                container.style.display = 'none'; // Hide all product containers
            });
            billingSection.style.display = 'none'; // Hide billing section

            // Reset billing section state when going back from billing/payment
            billingInputs.style.display = 'block'; // Show form inputs
            paymentInfoDiv.style.display = 'none'; // Hide payment info
            proceedToPaymentButton.style.display = 'block'; // Show proceed button
            submitOrderButton.style.display = 'none'; // Hide submit button
            // Restore button text and state
            submitOrderButton.textContent = 'Submit Inquiry / Payment Made';
            submitOrderButton.disabled = false;

            backToCartButton.style.display = 'inline-block'; // Show back button


            // Set search to work on categories
            searchItems = searchCategories; // Update the global searchItems function reference
            searchInput.onkeyup = searchItems; // Attach the correct search function to the input
            searchInput.value = ''; // Clear search input
            searchItems(); // Apply search filter if any text was present (should be empty)

            // No need to re-add image modal listeners here as delegation is used on #products
        }

        // Function to show a specific product container
        function showProductContainer(categoryId) {
             console.log("Attempting to show product container for categoryId:", categoryId); // Debug log
             const containerId = categoryId + '-products-container';
             const containerToShow = document.getElementById(containerId);
             console.log("Looking for container with ID:", containerId); // Debug log
             console.log("Found container:", containerToShow); // Debug log: Check if it's found (should not be null)

             if (!containerToShow) {
                 console.error("Product container not found for category:", categoryId);
                 showCategoryGrid(); // Fallback to category grid
                 return;
             }
             // Capitalize first letter for heading
             const categoryName = categoryId.charAt(0).toUpperCase() + categoryId.slice(1);
             productsHeading.textContent = `${categoryName} Collection`; // Update heading
             searchInput.placeholder = `Search ${categoryName} products...`; // Update search placeholder
             searchInput.style.display = 'block'; // Show search bar

             categoryGrid.style.display = 'none'; // Hide the category grid
             productContainers.forEach(container => {
                 container.style.display = 'none'; // Hide all product containers
             });
             billingSection.style.display = 'none'; // Hide billing section

              // Reset billing section state when navigating away
            billingInputs.style.display = 'block'; // Show form inputs
            paymentInfoDiv.style.display = 'none'; // Hide payment info
            proceedToPaymentButton.style.display = 'block'; // Show proceed button
            submitOrderButton.style.display = 'none'; // Hide submit button
             // Restore button text and state
             submitOrderButton.textContent = 'Submit Inquiry / Payment Made';
             submitOrderButton.disabled = false;

            backToCartButton.style.display = 'inline-block'; // Show back button


             containerToShow.style.display = 'block'; // Show the selected product container (use 'block' for container wrapper)
             console.log("Set display to 'block' for container:", containerToShow); // Debug log


             // Set search to work on products within this category
             searchItems = searchProductsInCategory; // Update the global searchItems function reference
             searchInput.onkeyup = searchItems; // Attach the correct search function to the input
             searchInput.value = ''; // Clear search input
             searchItems(); // Apply search filter if any text was present (should be empty)


             // Smooth scroll to the top of the products section
             document.getElementById('products').scrollIntoView({ behavior: 'smooth', block: 'start' });
             // No need to re-add image modal listeners here as delegation is used on #products
        }

         // Function to show the billing section (initial state with form inputs)
         function showBillingSection() {
             if (cart.length === 0) {
                 alert("Your cart is empty. Please add items before proceeding.");
                 cartModal.style.display = 'none'; // Close cart modal
                 return; // Prevent showing billing if cart is empty
             }

             productsHeading.textContent = 'Order Inquiry & Payment'; // Update heading
             searchInput.style.display = 'none'; // Hide search bar on billing page

             categoryGrid.style.display = 'none'; // Hide categories
             productContainers.forEach(container => {
                 container.style.display = 'none'; // Hide products
             });
             cartModal.style.display = 'none'; // Hide cart modal

             billingSection.style.display = 'block'; // Show billing section

             // Ensure initial state is billing form inputs visible, payment info hidden
             billingInputs.style.display = 'block';
             paymentInfoDiv.style.display = 'none';
             proceedToPaymentButton.style.display = 'block';
             submitOrderButton.style.display = 'none';
             // Restore button text and state
             submitOrderButton.textContent = 'Submit Inquiry / Payment Made';
             submitOrderButton.disabled = false;


             backToCartButton.style.display = 'inline-block'; // Show back button


             resetCoupon(); // Reset coupon state when showing billing
             renderOrderSummaryReview(); // Populate the review section

             // Smooth scroll to the top of the billing section
             billingSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
         }

          // Function to show the payment information and hide billing inputs
          function showPaymentInfo() {
              // Validate required fields before proceeding using the form's built-in validation
              const billingForm = document.getElementById('billingForm');
              if (!billingForm.checkValidity()) {
                  // If form is invalid, trigger browser's default validation messages
                  billingForm.reportValidity();
                  return false; // Prevent moving forward
              }


              billingInputs.style.display = 'none'; // Hide billing form inputs
              paymentInfoDiv.style.display = 'block'; // Show payment info
              proceedToPaymentButton.style.display = 'none'; // Hide proceed button
              submitOrderButton.style.display = 'block'; // Show submit button
              // Keep Back to Cart visible, maybe rename it conceptually or add Back to Billing?
              // Let's keep Back to Cart but add a Back to Billing option.
              // We can change the backToCartButton's behavior or add a new button.
              // Let's add a new "Back to Billing" button within #paymentInfo.

              // Update the email subject now that we are at the payment step
              document.getElementById('emailSubject').value = `J.K Gems Order Inquiry - Payment Details Shown`;


              return true; // Indicate success
          }


         // Function to hide the billing section and show the cart modal
         function hideBillingSection() {
             billingSection.style.display = 'none'; // Hide billing section
             cartModal.style.display = 'flex'; // Show cart modal again
             productsHeading.textContent = 'Your Cart'; // Change heading temporarily
             searchInput.style.display = 'none'; // Keep search hidden in modal

             // Reset billing section state when going back to cart
             billingInputs.style.display = 'block'; // Show form inputs
             paymentInfoDiv.style.display = 'none'; // Hide payment info
             proceedToPaymentButton.style.display = 'block'; // Show proceed button
             submitOrderButton.style.display = 'none'; // Hide submit button
             // Restore button text and state
             submitOrderButton.textContent = 'Submit Inquiry / Payment Made';
             submitOrderButton.disabled = false;


             backToCartButton.style.display = 'inline-block'; // Show back button

             // Smooth scroll back to the top of the products section (which now shows categories/cart context)
              document.getElementById('products').scrollIntoView({ behavior: 'smooth', block: 'start' });
         }


        // --- Updated Search Functionality ---
        // Search only categories when the category grid is visible
        function searchCategories() {
             const input = document.getElementById('searchInput');
             const filter = input.value.toUpperCase();
             // Get only the category cards within the visible category grid
             const categories = categoryGrid.querySelectorAll('.product.category-card'); // Select specifically

             categories.forEach(category => {
                 // Search text in heading and description
                 const h3 = category.querySelector('h3');
                 const description = category.querySelector('.product-description');
                 const textValue = (h3 ? h3.textContent || h3.innerText : '') + ' ' + (description ? description.textContent || description.innerText : '');
                 if (textValue.toUpperCase().indexOf(filter) > -1) {
                     category.style.display = ""; // Show
                 } else {
                     category.style.display = "none"; // Hide
                 }
             });
        }

        // Search only products within the currently visible category container
        function searchProductsInCategory() {
            const input = document.getElementById('searchInput');
            const filter = input.value.toUpperCase();
            // Get the currently visible category products grid
            const visibleProductGrid = document.querySelector('.category-products-container[style*="display: block"] .category-products-grid');

            if (!visibleProductGrid) {
                 console.warn("No visible product grid found for search.");
                 return; // Should not happen if views are managed correctly
            }

            const products = visibleProductGrid.querySelectorAll('.product'); // Get products within the visible grid

            products.forEach(product => {
                 // Search text in heading, description, and price
                 const h3 = product.querySelector('h3');
                 const description = product.querySelector('.product-description');
                 const priceElement = product.querySelector('.product-price'); // Include price in search
                 const textValue = (h3 ? h3.textContent || h3.innerText : '') + ' ' +
                                   (description ? description.textContent || description.innerText : '') + ' ' +
                                   (priceElement ? priceElement.textContent || priceElement.innerText : '');


                if (textValue.toUpperCase().indexOf(filter) > -1) {
                    product.style.display = ""; // Show
                } else {
                    product.style.display = "none"; // Hide
                }
            });
        }

        // The search function used by the input's onkeyup will be set dynamically
        let searchItems = searchCategories; // Initial function set on load


        // --- Image Modal Functionality ---
        const modal = document.getElementById('imageModal');
        const modalImg = document.getElementById('modalImage');
        const closeBtn = modal.querySelector('.close');

        // Add click listener to the modal close button
        closeBtn.addEventListener('click', function() {
            modal.style.display = 'none'; // Hide modal
        });

        // Add click listener to the modal background to close
        modal.addEventListener('click', function(e) {
            if (e.target === modal) { // Close only if clicking directly on the modal background
                modal.style.display = 'none';
            }
        });

        // Optional: Close with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && modal.style.display === 'flex') {
                modal.style.display = 'none';
            }
        });


        // --- Add to Cart & Billing/Payment Functionality ---
        const cartIcon = document.getElementById('cartIcon');
        const cartCountSpan = document.getElementById('cartCount');
        const cartModal = document.getElementById('cartModal');
        const closeCartModalBtn = document.getElementById('closeCartModal');
        const cartItemsList = document.getElementById('cartItemsList');
        const cartTotalDiv = document.getElementById('cartTotal');
        const checkoutButton = document.getElementById('checkoutButton'); // This button now goes to billing
        const emptyCartMessage = document.getElementById('emptyCartMessage');

        const reviewItemsList = document.getElementById('reviewItemsList'); // Billing review list
        const reviewSubtotalSpan = document.getElementById('reviewSubtotal');
        const reviewDiscountLine = document.getElementById('reviewDiscountLine');
        const reviewDiscountSpan = document.getElementById('reviewDiscount');
        const reviewFinalTotalSpan = document.getElementById('reviewFinalTotal');
        const orderCartDetailsInput = document.getElementById('orderCartDetails'); // Hidden input for cart data
        const parsedOrderDetailsInput = document.getElementById('_parsedOrderDetails'); // Hidden input for structured data
        const discountAppliedInput = document.getElementById('discountApplied'); // Hidden input for discount flag
        const finalOrderTotalInput = document.getElementById('finalOrderTotal'); // Hidden input for final total

        const couponCodeInput = document.getElementById('couponCode');
        const applyCouponButton = document.getElementById('applyCouponButton');
        const couponMessageDiv = document.getElementById('couponMessage');
        const couponSectionDiv = document.getElementById('couponSection'); // Coupon section div


        // Load cart from localStorage or initialize empty array
        let cart = JSON.parse(localStorage.getItem('jk-gems-cart')) || [];

        // Variables for coupon and total
        let currentSubtotal = 0;
        let discountPercentage = 0; // 0 for no discount
        let isCouponApplied = false;


        // Function to save cart to localStorage
        function saveCart() {
            localStorage.setItem('jk-gems-cart', JSON.stringify(cart));
        }

        // Function to update cart UI (count and list)
        function updateCartUI() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCountSpan.textContent = totalItems;

            // Hide count if 0
            cartCountSpan.style.display = totalItems > 0 ? 'block' : 'none';

            // Render cart content only when modal is open or about to open
             if (cartModal.style.display === 'flex') {
                 renderCart();
             }
        }

        // Function to add item to cart
        function addToCart(product) {
            const existingItemIndex = cart.findIndex(item => item.id === product.id);

            if (existingItemIndex > -1) {
                // Item already in cart, increase quantity
                cart[existingItemIndex].quantity++;
            } else {
                // Item not in cart, add it
                cart.push({...product, quantity: 1}); // Add quantity property
            }

            saveCart();
            updateCartUI();
             // Optional: Add visual feedback (e.g., fade-in message)
             console.log(`${product.name} added to cart!`); // Log to console
             // Simple alert for demonstration
             // alert(`${product.name} added to cart!`);
        }

        // Function to remove item from cart
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            saveCart();
            updateCartUI();
        }

        // Function to render cart items in the modal
        function renderCart() {
            cartItemsList.innerHTML = ''; // Clear current list
            let total = 0;

            if (cart.length === 0) {
                emptyCartMessage.style.display = 'block';
                cartTotalDiv.style.display = 'none';
                checkoutButton.style.display = 'none';
            } else {
                emptyCartMessage.style.display = 'none';
                cartTotalDiv.style.display = 'block';
                checkoutButton.style.display = 'block';

                cart.forEach(item => {
                    const listItem = document.createElement('li');
                    const itemTotal = item.price * item.quantity;
                    listItem.innerHTML = `
                        <div class="item-details">
                            <span class="item-name">${item.name}</span>
                            <span class="item-quantity"> (x${item.quantity})</span>
                            <br>
                            <span class="item-price">${itemTotal.toFixed(2)}</span>
                        </div>
                        <button class="remove-item" data-product-id="${item.id}">Remove</button>
                    `;
                    cartItemsList.appendChild(listItem);
                    total += item.price * item.quantity;
                });

                cartTotalDiv.textContent = `Total: ${total.toFixed(2)}`;
            }
        }

         // Function to render order summary in the billing section
         function renderOrderSummaryReview() {
             reviewItemsList.innerHTML = ''; // Clear current list
             currentSubtotal = 0; // Reset subtotal calculation

             if (cart.length === 0) {
                 // This case should ideally be prevented by checking before showing billing
                 reviewItemsList.innerHTML = '<li>Cart is empty.</li>';
                 reviewSubtotalSpan.textContent = '0.00';
                 reviewDiscountLine.style.display = 'none';
                 reviewDiscountSpan.textContent = '';
                 reviewFinalTotalSpan.textContent = '0.00';
             } else {
                 cart.forEach(item => {
                     const listItem = document.createElement('li');
                     const itemTotal = item.price * item.quantity;
                     listItem.innerHTML = `
                         <span class="item-name">${item.name} (x${item.quantity})</span>
                         <span class="item-price">${itemTotal.toFixed(2)}</span>
                     `;
                     reviewItemsList.appendChild(listItem);
                     currentSubtotal += itemTotal; // Calculate subtotal
                 });

                 reviewSubtotalSpan.textContent = `${currentSubtotal.toFixed(2)}`;

                 let finalTotal = currentSubtotal;
                 let discountAmount = 0;

                 if (isCouponApplied && discountPercentage > 0) {
                     discountAmount = currentSubtotal * (discountPercentage / 100);
                     finalTotal = currentSubtotal - discountAmount;
                     reviewDiscountSpan.textContent = `- ${discountAmount.toFixed(2)}`;
                     reviewDiscountLine.style.display = 'block';
                 } else {
                     reviewDiscountLine.style.display = 'none';
                     reviewDiscountSpan.textContent = '';
                 }

                 reviewFinalTotalSpan.textContent = `${finalTotal.toFixed(2)}`;

                 // Populate the hidden form fields with order details and final total
                 const orderDetailsText = cart.map(item =>
                     `${item.name} (Qty: ${item.quantity}) - ${(item.price * item.quantity).toFixed(2)}`
                 ).join('\n');

                 let fullOrderDetails = `Order Items:\n${orderDetailsText}\n\nSubtotal: ${currentSubtotal.toFixed(2)}`;

                 if (isCouponApplied && discountPercentage > 0) {
                     fullOrderDetails += `\nDiscount (${discountPercentage}%): -${discountAmount.toFixed(2)}`;
                 }
                 fullOrderDetails += `\nFinal Total: ${finalTotal.toFixed(2)}`;


                 orderCartDetailsInput.value = fullOrderDetails; // Text version for general use

                 // Optional: JSON version for potential future use or easier parsing
                 const parsedDetails = {
                     items: cart,
                     subtotal: currentSubtotal.toFixed(2),
                     discountApplied: isCouponApplied,
                     discountPercentage: discountPercentage,
                     discountAmount: discountAmount.toFixed(2),
                     finalTotal: finalTotal.toFixed(2)
                 };
                 parsedOrderDetailsInput.value = JSON.stringify(parsedDetails, null, 2); // Pretty print JSON


                 discountAppliedInput.value = isCouponApplied ? `Yes (${discountPercentage}%)` : 'No';
                 finalOrderTotalInput.value = finalTotal.toFixed(2);


             }
         }

         // Function to reset coupon state
         function resetCoupon() {
             discountPercentage = 0;
             isCouponApplied = false;
             couponCodeInput.value = '';
             couponMessageDiv.textContent = ''; // Clear message
             couponMessageDiv.className = ''; // Remove success/error classes
         }

         // Function to apply the coupon
         function applyCoupon() {
             const enteredCode = couponCodeInput.value.trim().toUpperCase(); // Case-insensitive check
             const validCouponCode = "OFFER10"; // The secret coupon code

             if (enteredCode === validCouponCode) {
                 discountPercentage = 10; // Set discount percentage
                 isCouponApplied = true;
                 couponMessageDiv.textContent = 'Coupon Applied! 10% discount added.';
                 couponMessageDiv.className = 'success'; // Apply success style
                 renderOrderSummaryReview(); // Update review with discount
             } else {
                 resetCoupon(); // Reset if incorrect code entered
                 couponMessageDiv.textContent = 'Invalid coupon code.';
                 couponMessageDiv.className = 'error'; // Apply error style
                 renderOrderSummaryReview(); // Update review (will show base total)
             }
         }


        // --- Event listener for interactions within the #products section using delegation ---
        document.getElementById('products').addEventListener('click', function(event) {
            const target = event.target;

            // --- Handle Clicks on Category Cards ---
            // Find the closest ancestor that is a category card
            const categoryCard = target.closest('.product.category-card');
            if (categoryCard) {
                const categoryId = categoryCard.dataset.categoryTarget;
                if (categoryId) {
                    showProductContainer(categoryId); // Call the function to show products for this category
                    return; // Stop processing after handling category click
                }
            }

            // --- Handle Clicks on "Add to Cart" Buttons ---
            if (target.classList.contains('add-to-cart-button')) {
                const productElement = target.closest('.product'); // Find the parent product div
                if (productElement) { // Ensure we are inside a product card
                    const product = {
                        id: target.dataset.productId,
                        name: target.dataset.productName,
                        price: parseFloat(target.dataset.productPrice) // Parse price as number
                    };
                    // Validate data
                    if (product.id && product.name && !isNaN(product.price)) {
                         addToCart(product);
                         // Optional: Add visual feedback (e.g., fade-in message)
                         console.log(`${product.name} added to cart!`); // Log to console
                    } else {
                         console.error("Missing or invalid product data for Add to Cart:", product);
                         alert("Could not add item to cart. Missing product details.");
                    }
                }
                return; // Stop processing after handling add to cart
            }

            // --- Handle Clicks on Product Images for Modal ---
            // Check if the clicked element is an IMG inside a .product card
            // And make sure it's not within the billing section (which is outside #products)
            if (target.tagName === 'IMG' && target.closest('.product') && !target.closest('#billingSection')) {
                // Check if it's a product image within a product container
                // We can simplify this check slightly if all images in products are intended for modal
                 if (target.closest('.category-products-grid .product')) { // Only images in product grids
                     modal.style.display = 'flex'; // Use flex to center
                     modalImg.src = target.src; // Set modal image source
                     modalImg.alt = target.alt; // Set modal image alt text for accessibility
                 }
            }
        });


         // Event listener for "Remove" buttons in the cart modal using delegation
         cartItemsList.addEventListener('click', function(event) {
             const target = event.target;
             if (target.classList.contains('remove-item')) {
                 const productId = target.dataset.productId;
                 if (productId) {
                     removeFromCart(productId);
                 }
             }
         });


        // Event listeners for Cart Modal
        cartIcon.addEventListener('click', function() {
            cartModal.style.display = 'flex'; // Show modal
             renderCart(); // Render cart content every time modal opens
        });

        closeCartModalBtn.addEventListener('click', function() {
            cartModal.style.display = 'none'; // Hide modal
        });

        // Close modal if user clicks outside of it
        cartModal.addEventListener('click', function(e) {
            if (e.target === cartModal) {
                cartModal.style.display = 'none';
            }
        });

        // Event listener for the "Proceed to Inquiry" button (in the cart modal)
        checkoutButton.addEventListener('click', function() {
            // cartModal.style.display = 'none'; // Hide cart modal - this is handled in showBillingSection
            showBillingSection(); // Show the billing section
        });

         // Event listener for the coupon code apply button
         applyCouponButton.addEventListener('click', applyCoupon);

         // Allow applying coupon by pressing Enter in the input field
         couponCodeInput.addEventListener('keypress', function(event) {
             if (event.key === 'Enter') {
                 event.preventDefault(); // Prevent form submission if input is inside a form
                 applyCoupon();
             }
         });


         // Event listener for the FIRST click on the billing form button
         proceedToPaymentButton.addEventListener('click', function(event) {
              // Prevent default form submission initially
             // event.preventDefault(); // No form event listener on the button itself

             // Validate and show payment info using HTML5 validation API
             showPaymentInfo();

             // The event listener for form submission will be on the form itself,
             // and will only be triggered when submitOrderButton is clicked.

         });

         // Event listener for the SECOND click on the billing form button (now submitOrderButton)
         // This button is type="submit" and is inside the form, so it naturally triggers form submission.
         document.getElementById('billingForm').addEventListener('submit', function(event) {
             // This listener is called when the submitOrderButton is clicked.

             // Add client-side feedback
             const submitButton = document.getElementById('submitOrderButton');
             submitButton.textContent = 'Submitting...';
             submitButton.disabled = true; // Disable button to prevent double clicks


             // Optional: Add final checks before clearing cart and submitting
             // e.g., confirm user has made payment - This is a manual step for the user after seeing payment info

             // Clear the cart after the form submission attempt.
             // As noted before, this is client-side and not server-side secure.
             // Clearing AFTER the form submission is attempted is the correct place.
              cart = [];
              saveCart();
              updateCartUI(); // Update header count immediately
              // Reset coupon state on successful order/inquiry submission
              resetCoupon();

              // The form will submit normally via formsubmit.co's action
              // The _next parameter will redirect the user.
              // If submission fails (e.g., network error) before redirect, the button will remain disabled.
              // For better error handling, one might use Fetch API instead of native form submit,
              // but for simplicity with formsubmit.co, native submit is standard.
         });

        // --- Add Back Button Listeners (Ensure these exist and are correct) ---
        document.querySelectorAll('.back-to-categories').forEach(button => {
            button.addEventListener('click', function(event) {
                event.preventDefault(); // Prevent default link behavior
                showCategoryGrid(); // Show the category grid
                 // Smooth scroll back to the top of the products section
                 document.getElementById('products').scrollIntoView({ behavior: 'smooth', block: 'start' });
            });
        });

        // Listener for the back to cart button in the billing section
        document.querySelector('.back-to-cart').addEventListener('click', function(event) {
            event.preventDefault();
            hideBillingSection(); // Hide billing and show cart modal
        });


        // Initializers
        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM Content Loaded. Initializing..."); // Debug log

            // Apply theme preference from localStorage
            applyThemePreference();

            const initialCategoryCards = document.querySelectorAll('.category-card'); // Get cards immediately
            console.log("Found", initialCategoryCards.length, "category cards on DOMContentLoaded."); // Debug log: Check count
            showCategoryGrid(); // Make sure categories are shown initially
            updateCartUI(); // Load and display initial cart state
            // Delegation for image modal clicks is set up outside DOMContentLoaded
        });


        // Feature: Optional - Add a slight reveal animation on scroll
        const sections = document.querySelectorAll('.section');

        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = 1;
                    entry.target.style.transform = 'translateY(0)';
                    observer.unobserve(entry.target); // Stop observing once visible
                }
            });
        }, {
            threshold: 0.1, // Trigger when 10% of the section is visible
            rootMargin: '0px 0px -50px 0px' // Start observing slightly before it enters
        });

        sections.forEach(section => {
             // Apply animation only to main sections, not modals or billing section
             if (!section.id.includes('Modal') && section.id !== 'billingSection') {
                section.style.opacity = 0;
                section.style.transform = 'translateY(20px)';
                section.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
                observer.observe(section);
             }
        });

    </script>

</body>
</html>
